sudo: required

language: generic

  
matrix:

  include:
  
    - os: linux
      python: 2.7
      env: TRAVIS_PYTHON_VERSION=2.7
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

           
    - os: osx
      python: 2.7
      env: TRAVIS_PYTHON_VERSION=2.7
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false
           
    - os: linux
      python: 2.7
      env: TRAVIS_PYTHON_VERSION=2.7
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: osx
      python: 2.7
      env: TRAVIS_PYTHON_VERSION=2.7
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: linux
      python: 3.5
      env: TRAVIS_PYTHON_VERSION=3.5
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

    - os: osx
      python: 3.5
      env: TRAVIS_PYTHON_VERSION=3.5
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

    - os: linux
      python: 3.6
      env: TRAVIS_PYTHON_VERSION=3.6
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

    - os: osx
      python: 3.6
      env: TRAVIS_PYTHON_VERSION=3.6
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

    - os: linux
      python: 3.7
      env: TRAVIS_PYTHON_VERSION=3.7
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

    - os: osx
      python: 3.7
      env: TRAVIS_PYTHON_VERSION=3.7
           TEST_WITH_XSPEC=false
           CONDA_UPLOAD=false

    - os: linux
      python: 3.5
      env: TRAVIS_PYTHON_VERSION=3.5
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: osx
      python: 3.5
      env: TRAVIS_PYTHON_VERSION=3.5
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: linux
      python: 3.6
      env: TRAVIS_PYTHON_VERSION=3.6
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: osx
      python: 3.6
      env: TRAVIS_PYTHON_VERSION=3.6
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: linux
      python: 3.7
      env: TRAVIS_PYTHON_VERSION=3.7
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true

    - os: osx
      python: 3.7
      env: TRAVIS_PYTHON_VERSION=3.7
           TEST_WITH_XSPEC=true
           CONDA_UPLOAD=true


           
           
before_install:
  - |
       if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then
         #docker pull condaforge/linux-anvil

         wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh -O miniconda.sh
         bash miniconda.sh -b -p $HOME/miniconda
         export PATH="$HOME/miniconda/bin:$PATH"
         conda install -y conda-build
         conda config --add channels conda-forge
       else

         # Install Miniconda
         wget https://repo.continuum.io/miniconda/Miniconda3-latest-MacOSX-x86_64.sh -O miniconda.sh
         bash miniconda.sh -b -p $HOME/miniconda
         export PATH="$HOME/miniconda/bin:$PATH"
         conda install -y conda-build
         conda config --add channels conda-forge

       fi

script:
  - chmod u+x ci/build_and_test.sh
  - |
    while sleep 500; do
       echo "====[ $SECONDS seconds still running ]===="
    done &
  - ./ci/build_and_test.sh

